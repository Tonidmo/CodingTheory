<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>The Vardy-Be’ery Decomposition · Coding Theory Documentation</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Coding Theory Documentation logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Coding Theory Documentation</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../Tutorials/Linear Codes/">Linear Codes</a></li><li><a class="tocitem" href="../../Tutorials/Cyclic Codes/">Cyclic Codes</a></li><li><a class="tocitem" href="../../Tutorials/Quantum Codes/">Quantum Codes</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>The Vardy-Be’ery Decomposition</a><ul class="internal"><li><a class="tocitem" href="#Background"><span>Background</span></a></li><li><a class="tocitem" href="#The-Almost-Block-Diagonal-Form"><span>The Almost-Block-Diagonal Form</span></a></li><li><a class="tocitem" href="#Explicit-Example"><span>Explicit Example</span></a></li></ul></li><li><a class="tocitem" href="../Quantum Reed-Muller Codes/">Quantum Reed-Muller Codes</a></li></ul></li><li><span class="tocitem">Classical</span><ul><li><a class="tocitem" href="../../Classical/linearcode/">Linear Codes</a></li><li><a class="tocitem" href="../../Classical/cycliccode/">Cyclic Codes</a></li><li><a class="tocitem" href="../../Classical/quasicyclic/">Quasi-Cyclic Codes</a></li><li><a class="tocitem" href="../../Classical/GeneralizedReedSolomon/">Generalized Reed-Solomon Codes</a></li><li><a class="tocitem" href="../../Classical/ReedMuller/">Reed-Muller Codes</a></li><li><a class="tocitem" href="../../Classical/newcodesfromold/">Modifying Codes</a></li><li><a class="tocitem" href="../../Classical/productcodes/">Product Codes</a></li><li><a class="tocitem" href="../../Classical/miscknowncodes/">Miscellaneous Known Linear Codes</a></li><li><a class="tocitem" href="../../Classical/LDPC/">LDPC Codes</a></li></ul></li><li><span class="tocitem">Quantum</span><ul><li><a class="tocitem" href="../../Quantum/quantumcode/">Notes</a></li><li><a class="tocitem" href="../../Quantum/quantumproductcodes/">Product Codes</a></li><li><a class="tocitem" href="../../Quantum/miscknownquantumcodes/">Miscellaneous Known Stabilizer Codes</a></li></ul></li><li><span class="tocitem">Misc</span><ul><li><a class="tocitem" href="../../tilings/">Tilings</a></li><li><a class="tocitem" href="../../trellis/">Trellises</a></li><li><a class="tocitem" href="../../utils/">Utilies</a></li><li><a class="tocitem" href="../../weight_dist/">Weight Enumerators, Distributions, And Minimum Distances</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li><li><a class="tocitem" href="../../theindex/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>The Vardy-Be’ery Decomposition</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>The Vardy-Be’ery Decomposition</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/esabo/CodingTheory/blob/master/docs/src/Examples/The Vardy-Be’ery Decomposition.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="The-Vardy-Be’ery-Decomposition"><a class="docs-heading-anchor" href="#The-Vardy-Be’ery-Decomposition">The Vardy-Be’ery Decomposition</a><a id="The-Vardy-Be’ery-Decomposition-1"></a><a class="docs-heading-anchor-permalink" href="#The-Vardy-Be’ery-Decomposition" title="Permalink"></a></h1><h2 id="Background"><a class="docs-heading-anchor" href="#Background">Background</a><a id="Background-1"></a><a class="docs-heading-anchor-permalink" href="#Background" title="Permalink"></a></h2><p>Before getting into the main application, let us briefly review the necessary background from classical coding theory.</p><p>Let <span>$\mathcal{C}$</span> be an <span>$[n, k, d]_{p^m}$</span> code. Then the subfield subcode of <span>$\mathcal{C}$</span> over a subfield <span>$\mathbb{F} \leq \mathbb{F}_{p^m}$</span>, denoted <span>$\mathcal{C}|_\mathbb{F}$</span>, is given by <span>$\mathcal{C} \cap \mathbb{F}^n$</span>, i.e., the collection of codewords of <span>$\mathcal{C}$</span> whose components lie entirely in <span>$\mathbb{F}$</span>. The code <span>$\mathcal{C}$</span> is called the supercode of <span>$\mathcal{C}|_\mathbb{F}$</span>. If <span>$\mathcal{C}$</span> has parameters <span>$[n, k, d]_{p^m}$</span>, <span>$\mathcal{C}|_\mathbb{F}$</span> has parameters <span>$[n, k^\prime, \geq d]$</span> over <span>$\mathbb{F}$</span>, where <span>$n - k \leq n - k^\prime \leq \ell (n - k)$</span> and <span>$\ell = [\mathbb{F}_{p^m} : \mathbb{F}]$</span> (the index of <span>$\mathbb{F}$</span> in <span>$\mathbb{F}_{p^m}$</span>). As the codewords of <span>$\mathcal{C}|_\mathbb{F}$</span> are codewords of <span>$\mathcal{C}$</span>, it follows immediately that the minimum distance of <span>$\mathcal{C}|_\mathbb{F}$</span> is at least the minimum distance of <span>$\mathcal{C}$</span>, and <span>$\mathcal{C}|_\mathbb{F}$</span> can be decoded using the same algorithm as <span>$\mathcal{C}$</span>, although perhaps not efficiently as a native algorithm over <span>$\mathbb{F}$</span> designed specifically for the subfield subcode.</p><p>If <span>$\mathcal{C}$</span> is an <span>$[n, k, d]_{p^m}$</span> Reed-Solomon code, then <span>$\mathcal{C}|_{\mathbb{F}_p}$</span> is the BCH code over <span>$\mathbb{F}_p$</span> of length <span>$n$</span> and designed distance <span>$d$</span>. The proof of this follows immediately from the fact that the codewords of the BCH code are elements of <span>$\mathbb{F}_p^n$</span> and the zero set of the Reed-Solomon code is a subset of the zero set of the BCH code.</p><p>An <span>$[mn, mk, \geq d]_p$</span> code may be constructed from an <span>$[n, k, d]_{p^m}$</span> code by expanding its elements using a basis of <span>$\mathbb{F}_{p^m}/\mathbb{F}_p$</span>. The first code is called the expanded code of the second. To see why the minimum distance of the code could increase, let <span>$\beta = \{\beta_j\}_1^m$</span> be a basis of <span>$\mathbb{F}_{p^m}/\mathbb{F}_p$</span> and let <span>$c = (c_1, \dots, c_n) \in \mathbb{F}^n_{p^m}$</span> be a minimum weight codeword in an <span>$[n, k, d]_{p^m}$</span> code. Expressing each <span>$c_i$</span> with respect to <span>$\beta$</span>, <span>$c_i = \sum_j c_{ij} \beta_j$</span>, we can replace each element with its corresponding <span>$m$</span>-tuple, <span>$(c_{i1}, \dots, c_{im})$</span>. If  <span>$c_i \neq 0$</span>, then the Hamming weight of its expansion is at least one and therefore the Hamming weight of the expansion of <span>$c$</span> is at least <span>$d$</span>.</p><p>Recall that the inner product over finite fields is given by the trace. In particular, if <span>$\beta$</span> is a basis of <span>$\mathbb{F}_{p^m}/\mathbb{F}_p$</span> such that <span>$x = \sum_{j = 1}^m x_j \beta_j$</span> for <span>$x \in \mathbb{F}_{p^m}$</span>, then <span>$x_j = \mathrm{Tr}_{\mathbb{F}_{p^m}/\mathbb{F}_p} (x \beta_j^\perp) \in \mathbb{F}_p$</span>, where <span>$\beta^\perp$</span> is the unique trace-orthogonal dual of <span>$\beta$</span> such that <span>$\mathrm{Tr}_{\mathbb{F}_{p^m}/\mathbb{F}_p}(x_i y_j) = \delta_{ij}$</span> for <span>$x_i \in \beta$</span> and <span>$y_j \in \beta^\perp$</span>. (The dual basis always exists and is easy to compute given <span>$\beta$</span>.) For <span>$c = (c_1, \dots, c_n) \in \mathbb{F}_{p^m}^n$</span> denote the expansion with respect to <span>$\beta$</span> by the isomorphism <span>$\phi_\beta: \mathbb{F}_{p^m}^n \to \mathbb{F}_p^{nm}$</span> given by</p><p class="math-container">\[\begin{aligned}
	\phi_\beta(c) &amp;= (\phi_\beta(c_1), \dots, \phi_\beta(c_n))\\
		&amp;= (\mathrm{Tr}_{\mathbb{F}_{p^m}/\mathbb{F}_p}(c_1 \beta_1^\perp), \dots, \mathrm{Tr}_{\mathbb{F}_{p^m}/\mathbb{F}_p}(c_1 \beta_m^\perp), \mathrm{Tr}_{\mathbb{F}_{p^m}/\mathbb{F}_p}(c_2 \beta_1^\perp), \dots, \mathrm{Tr}_{\mathbb{F}_{p^m}/\mathbb{F}_p}(c_n \beta_m^\perp)).
\end{aligned}\]</p><p>If <span>$\mathcal{C}$</span> is a code, let <span>$\phi_\beta(C)$</span> denote the corresponding expanded code. In general, an expanded code loses the properties of its parent code and different bases could produce different expanded codes with different parameters and properties. It is still not yet known how to choose a basis to <em>a priori</em> maximize the minimum distance of the expanded code.</p><h2 id="The-Almost-Block-Diagonal-Form"><a class="docs-heading-anchor" href="#The-Almost-Block-Diagonal-Form">The Almost-Block-Diagonal Form</a><a id="The-Almost-Block-Diagonal-Form-1"></a><a class="docs-heading-anchor-permalink" href="#The-Almost-Block-Diagonal-Form" title="Permalink"></a></h2><p>Vardy and Be&#39;ery showed that expanded (cyclic) Reed-Solomon codes may be seen as interleaved BCH codes plus some extra &quot;glue&quot;.</p><div class="admonition is-info"><header class="admonition-header">The Vardy-Be’ery Decomposition</header><div class="admonition-body"><p>Let <span>$\mathcal{C}$</span> be a cyclic Reed-Solomon code over <span>$\mathbb{F}_{p^m}$</span> for <span>$p, m \geq 2$</span>. Using column permutations, the expanded generator matrix can be put into the form of Figure \ref{fig:blockstruct}, where <span>$B$</span> is the generator matrix of the corresponding BCH subfield subcode <span>$\mathcal{B}$</span>.</p></div></div><p>The proof of this is easy. Instead of expanding <span>$\mathcal{C}$</span> in its entirety, first perform the expansion on <span>$\mathcal{B} \subset \mathcal{C}$</span> only. As a subfield subcode, the codewords of <span>$\mathcal{B}$</span> are closed in <span>$\mathcal{C}$</span> under scalar multiplication in <span>$\mathbb{F}_{p^m}$</span>. Choose a basis, <span>$\beta$</span>, of <span>$\mathbb{F}_{p^m}/\mathbb{F}_p$</span> and let <span>$\mathcal{B}_i = \{ \beta_i b \, : \, b \in \mathcal{B} \}$</span>. Clearly the <span>$\mathcal{B}_i$</span> are disjoint subcodes of <span>$\mathcal{C}$</span>. For <span>$b = (b_1, \dots, b_n)$</span>, a row of the generator matrix of <span>$\mathcal{B}$</span>, the expansion of <span>$\beta_i b$</span> gives <span>$m$</span> rows of the form</p><p class="math-container">\[\begin{aligned}
	&amp;(b_1, 0, \dots, 0, b_2, 0, \dots, 0, b_n, 0, \dots, 0),\\
	&amp;(0, b_1, 0, \dots, 0, b_2, 0, \dots, 0, b_n, 0, \dots, 0),\\
	&amp;(0, 0, b_1, 0, \dots, 0, b_2, 0, \dots, 0, b_n, 0, \dots, 0),
\end{aligned}\]</p><p>where we have used the fact that <span>$\mathrm{Tr}_{\mathbb{F}_{p^m}/\mathbb{F}_p}$</span> is <span>$\mathbb{F}_p$</span>-linear and <span>$\mathrm{Tr}_{\mathbb{F}_{p^m}/\mathbb{F}_p}(b_\ell \beta_i \beta_j^\perp) = b_\ell \delta_{ij}$</span>. There are <span>$m - 1$</span> zeros (cyclically) between each non-zero element. Permuting columns put these into the form</p><p class="math-container">\[\begin{aligned}
	&amp;(b_1, \dots, b_n, 0, \dots, 0, 0, \dots 0),\\
	&amp;(0, \dots, 0, b_1, \dots, b_n, 0, \dots 0),\\
	&amp;(0, \dots, 0, 0, \dots 0, b_1, \dots, b_n).
\end{aligned}\]</p><p>Repeating this for all of the rows of the generator matrix of <span>$\mathcal{B}$</span> then permuting rows completes the <span>$m$</span> factors of <span>$B \oplus \dots \oplus B$</span>.</p><p>If <span>$\mathcal{C}$</span> has dimension <span>$k$</span> and <span>$\mathcal{B}$</span>, <span>$k^\prime$</span>, then <span>$m(k - k^\prime)$</span> more &quot;glue vectors&quot; are required to span the expanded code, <span>$\phi_\beta (\mathcal{C})$</span>. These must be inside of <span>$\phi_\beta (\mathcal{C})$</span> but with a nonzero component outside out <span>$\mathcal{B}_i$</span> if we want the generator matrix to be full rank. The remaining vectors are therefore a basis of the row space of <span>$\phi_\beta(\mathcal{C}) / \left(\oplus_{i = 1}^m B_i\right)$</span>. The literature often describes the glue vectors as sums of minimum-weight coset leaders of <span>$\mathcal{B}$</span> considered as polynomials also satisfying the zeros of <span>$\mathcal{C}$</span> \cite{halford2005soft}; however, the standard coset leaders algorithm makes this difficult to use for even small codes. Instead, these may be computed, even for large codes, using elementary linear algebra using the same algorithm one would for computing the quotient space of two modules. If being used to, for example, connect different hardware modules (corresponding to each <span>$\mathcal{B}$</span>) on a quantum computer, it may be experimentally advantageous to further enforce that the glue vectors be of specific weight or as low-weight as possible. This can be done by selecting appropriate elements from <span>$\phi_\beta(\mathcal{C}) / \left(\oplus_{i = 1}^m B_i\right)$</span> using <code>minimumwords</code> that together have full rank.</p><p>This method is highly constrained as the resulting code always has length <span>$m(p^m - 1)$</span>. In a separate 1994 paper \cite{vardy1994maximum}, Vardy and Be&#39;ery showed that binary, primitive BCH codes and binary BCH codes of composite block length may also be put into the form above. We will also refer to this as a Vardy-Be’ery decomposition since the proper technique should be clear from context. For primitive BCH codes, they extended the code and then split the zeros into partitions satisfying certain properties. The direct-sum subcodes are then obtained by puncturing on the set complement of the indices corresponding to the defining sets of each partition. This applies directly to Reed-Muller codes. We will not use this approach here but instead consider BCH codes of composite block length. The two approaches are almost identical except that in the latter case the partitions are immediate from the structure of the code. The following applies to cyclic codes in general.</p><p>Let <span>$\mathcal{C}$</span> be a BCH code over <span>$\mathbb{F}_2$</span> of composite length <span>$n = n_h n_q$</span> with defining set <span>$C^n_b \cup \dots \cup C^n_{b + \delta - 2}$</span>. Consider the sets <span>$\mathcal{I}_i = \{1 + j + i \cdot n_h\}$</span> where <span>$0 \leq j \leq n_h - 1$</span> for fixed <span>$0 \leq i \leq n_q - 1$</span>.</p><div class="admonition is-info"><header class="admonition-header">Lemma</header><div class="admonition-body"><p>The code obtained from <span>$\mathcal{C}$</span> punctured on the complement, <span>$\mathcal{I}_i^c$</span>, is a BCH code of length <span>$n_q$</span> with defining set <span>$C^{n_q}_b \cup \dots \cup C^{n_q}_{b + \delta - 2}$</span>.</p></div></div><p>While the second paper does not cite the first paper, the first result may seen as a special case of the second, where the sets <span>$\mathcal{I}_i$</span> are the non-zero locations of the matrices above.</p><h2 id="Explicit-Example"><a class="docs-heading-anchor" href="#Explicit-Example">Explicit Example</a><a id="Explicit-Example-1"></a><a class="docs-heading-anchor-permalink" href="#Explicit-Example" title="Permalink"></a></h2><p>TODO: work everything out by hand here and come up with an example for both decomps</p><p>To demo this, we first define the permutation matrix required to put the columns into the almost-block-diagonal form above.</p><pre><code class="nohighlight hljs">julia&gt; function permutationmatrix(F::CodingTheory.CTFieldTypes, n1::Int, n2::Int)
           # usage: P = permutationmatrix(GF(2), 15, 3) for 3 modules of size 15 each
           arr = [1 + j + i * n2 for j in 0:(n2 - 1) for i in 0:(n1 - 1)]
           P = zero_matrix(F, n1 * n2, n1 * n2)
           Fone = F(1)
           for i in 1:(n1 * n2)
               P[arr[i], i] = Fone
           end
           return P
       end
permutationmatrix (generic function with 1 method)</code></pre><pre><code class="nohighlight hljs">q = 2; n = 45; nq = 15; nh = 3; bX = 0; δX = 7;
CBigX = BCHCode(q, n, δX, bX);
CSmX = BCHCode(q, nq, δX, bX);
PX = permutationmatrix(field(CBigX), nq, nh);
CBigXP = LinearCode(generatormatrix(CBigX) * PX);
CblockX = LinearCode(generatormatrix(CSmX) ⊕ generatormatrix(CSmX) ⊕ generatormatrix(CSmX));
QCX = CBigXP / CblockX;
CPfullX = augment(CblockX, generatormatrix(QCX));
areequivalent(CPfullX, CBigXP)
</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../Tutorials/Quantum Codes/">« Quantum Codes</a><a class="docs-footer-nextpage" href="../Quantum Reed-Muller Codes/">Quantum Reed-Muller Codes »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Tuesday 23 May 2023 21:09">Tuesday 23 May 2023</span>. Using Julia version 1.9.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
